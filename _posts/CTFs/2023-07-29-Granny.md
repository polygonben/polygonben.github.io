---
title: "HackTheBox - Granny - OSCP Prep (Without Metasploit)"
categories:
  - CTF Writeups
toc: true
---

This is an easy rated Windows machine on [TJ Null's](https://docs.google.com/spreadsheets/u/1/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/htmlview#) OSCP prep list. Due to OSCP restrictions on auto-pwn tools, we will be purposefully doing this challenge without Metasploit. 

Keep in mind, you can solve this with Metasploit within minutes!

# Reconnaissance

## Nmap 

`nmap -p- -T4 -sV -sC -v -o full_thorough.log granny.htb`

[![1](/assets/images/Granny/1.png)](/assets/images/Granny/1.png){: .full}

Nice, just one port open. This narrows down possible our exploitation methods giving us a handful clear routes to initial access. It's also looking like a WebDAV server, let's enumerate this further!

## Web

Let's begin with some basic directory enumeration to see if there are any folders which we can investigate!

### ffuf

`ffuf -w /usr/.../Web-Content/directory-list-2.3-small.txt -u http://granny.htb/FUZZ -fc 404`

[![2](/assets/images/Granny/2.png)](/assets/images/Granny/2.png){: .full}

This doesn't discover anything interesting.

### davtest

As this is a WebDAV server, we should of course check if it's possible to upload a webshell. `davtest` is a tool that will do just this!

`davtest -url http://granny.htb`

[![3](/assets/images/Granny/3.png)](/assets/images/Granny/3.png){: .full}

It looks liuke we can upload mutiple file types succesfully, but can unfortunately only execute `.html` & `.txt`, meaning RCE via this would not work.

### IIS 6.0

You may have noticed from our nmap scan that IIS 6.0 is running, which is also very outdated. Let's research if their are any vulnerabilities, or publically accessible exploits, for this specific version.

After a quick Google, I discovered [this](https://www.trendmicro.com/en_us/research/17/c/iis-6-0-vulnerability-leads-code-execution.html) article. It's an article explaining [CVE-2017-7269](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7269), a Buffer Overflow vulnerability in the ScStoragePathFromUrl function in WebDAV! 

# Initial Access

##  
